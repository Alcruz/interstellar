\section{Finite difference schemes} \label{sec:finitedifferencesschemes}
\subsection{Overview}

In this section, we present explicit and implicit central finite difference schemes for solving the PDE problem in \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde}. Previously, we considered the pricing problem of American options which requires solving the free boundary problem defined in \eqref{eq:blackscholes:preliminaries:american_options_pde_free_boundary_problem_full}.
Then, we presented the front fixing method as a strategy to fix the moving boundary using a change of variable. Moreover, we derived the PDE problem for call and put options that resulted from applying the Nielsen transformation suggested by \cite{nielsen_2001}, and the Company transformation suggested by \cite{company_egorova_jodar_2014}, resulting in the systems \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde} and \eqref{eq:blackscholes:frontfixingmethod:logtransform:american_options_bs_pde}, respectively. In the following part, we present numerical methods for solving \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde}. But before we jump into that, we define what it means to compute a numerical solution to a PDE problem.

Recall that the solution $v(x,t)$ of 
\eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde} is defined in the continuous region 
\begin{subequations}
  \label{eq:finitedifferencesschemes:overview:continous_domain}
\begin{align}
  \text{\textbf{Call:}} \qquad& \mathcal{T}: [0, T], \qquad \mathcal{X}: [0, 1], \qquad  \mathcal{F}: \mathcal{X} \times \mathcal{T} \\
  \text{\textbf{Put:}} \qquad& \mathcal{T}:[0, T], \qquad \mathcal{X}:[1, \infty), \qquad \mathcal{F}: \mathcal{X} \times \mathcal{T},
\end{align}
\end{subequations}
Now, we want to discretize $\mathcal{F}$ using the grid $\mathcal{G}$ with $N+1$ and $M+1$ nodes
\begin{align}
  \label{eq:finitedifferencesschemes:overview:grid}
  \mathcal{G} := \{(x_i, t_n): (i, n) \in \{0,\dots,M+1\}\times\{0,\dots,N+1\}\}
\end{align}
where
\begin{align}
  \label{eq:finitedifferencesschemes:overview:grid_2}
  x_i &:= x_{\text{min}} + i\Delta x &  \qquad \text{for $i = 0,\dots, M+1$} \\
  t_n &:= t_{\text{min}} + i{\Delta t} & \qquad \text{for $i = 0,\dots, N+1$} \\
  \Delta{x} &:= \dfrac{x_{\text{max}} - x_{\text{min}}}{M+1} \\ 
  \Delta{t} &:= \dfrac{t_{\text{max}} - t_{\text{min}}}{N+1}
\end{align}
Each contiguous node will be separated by $\Delta{x}$ on the spatial axis and $\Delta{t}$ on the temporal axis. As $\Delta{x}$ and $\Delta{t}$ decreases, the number of nodes in the grid will increase. Therefore, we refer to $\Delta{x}$ and $\Delta{t}$ as the resolution of the grid.
\begin{figure}[H]
  \label{fig:finitedifferencesschemes:overview:grid}
  \centering
  \includegraphics[scale=0.5]{chapters/chapter3/GridAproximation.pdf}
  \caption{The grid $\mathcal{G}$ and the approximation $v^{n}_{i} \approx v(x_i, t_n)$ in each node.}
\end{figure}
From \eqref{eq:finitedifferencesschemes:overview:continous_domain}, it is clear that $t_\text{min} = 0$ and $t_\text{max}=T$. Moreover, for call options, $x_\text{min} = 0$ and $x_\text{max}=1$. Likewise, for put options, $x_\text{min}=1$ and $x_\text{max}=x_\infty$ where $x_\infty$ is arbitrary large value.
Now that we defined our grid, our goal is to approximate the value function $v(x, t)$ and the optimal exercise price $\bar{S}(t)$ at each node of the grid $\mathcal{G}$
\begin{align*}
  v^{n}_i \approx v(x_i,t_n), \quad \bar{S}^{n} \approx \bar{S}(t_n)
\end{align*}
Moreover, we want that the error of the approximation converges to zero value. Specifically, we want that the approximation error at each node 
\begin{align}
  \label{eq:finitedifferencesschemes:overview:local_truncation_error}
  e^{n}_i := v^{n}_i-v(x_i, t_n)
\end{align}
goes to zero as $\Delta{x}$ and $\Delta{t}$ decrease. \eqref{eq:finitedifferencesschemes:overview:local_truncation_error} is the local truncation error, and it measures the approximation error at time $t_n$. It is important to state if a single node has inferior order than the rest of the nodes, it might degrade the order of the truncation error in overall.   

Finally, we need ways to approximate derivatives. Here is where finite differences schemes come into play. The idea of finite differences is trivial which is approximating derivatives as the difference of contiguous nodes in the grid. Let us say we are at point $x$, then the forward differences approximate the derivative as
\begin{align*}
 \dfrac{f(x + h) - f(x)}{h} = \dfrac{df}{dx} + O(h)
\end{align*}
Conversely, the backward difference approximate the derivative as 
\begin{align*}
  \dfrac{f(x) - f(x-h)}{h} = \dfrac{df}{dx} + O(h)
\end{align*}
As you can observe forward and backward difference approximation yield a local truncation error of $O(h)$. Moreover, the central finite difference approximate the first order derivative as 
\begin{align*}
  \dfrac{f(x+h) - f(x-h)}{2h} = \dfrac{df}{dx} + O(h^2)
 \end{align*}
and for second order derivatives as
\begin{align*}
  \dfrac{f(x+h) - 2f(x) + f(x-h)}{h^2} = \dfrac{d^2f}{dx^2} + O(h^2)
 \end{align*}
Note that both approximation offers a better order of convergence that forward and backward difference, but you are required to come up with strategies for approximating the derivative at the boundary of your grid where $x+h$ or $x-h$ is not defined.

\subsection{Explicit scheme}
Generally, explicit schemes use forward finite difference to approximate the temporal partial derivative and central finite difference to approximate the spatial derivative at time $t_{n+1}$ and position $x_i$. However, since the problem \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde} is written backward in time, we use backward finite difference at $t_{n+1}$, and a central finite difference at $x_i$.

\begin{figure}[H]
  \centering
  \includegraphics[scale=.8]{chapters/chapter3/ExplicitStencil.pdf}
  \caption{Stencil diagram of the explicit scheme.}
  \label{fig:finitedifferencesschemes:explicit_stencil}
\end{figure}

The central finite difference for the first order and second order spatial partial derivative is given by
\begin{align}
  \label{eq:finitedifferencesschemes:explicit:spatial_first_order_central_finite_difference}
  \dfrac{v^{n+1}_{i+1} - v^{n+1}_{i-1}}{2 \Delta{x}} =& \dfrac{\partial{v}}{\partial{x}}+ O(\Delta{x}^2) \qquad & \text{for $i = 1, \dots, M$} \\
  \label{eq:finitedifferencesschemes:explicit:spatial_second_order_central_finite_difference}
  \dfrac{v^{n+1}_{i+1} - 2v^{n+1}_{i} + v^{n+1}_{i-1}}{\Delta{x}^2} =& \dfrac{\partial^2{v}}{\partial{x^2}}+ O(\Delta{x}^2) \qquad & \text{for $i = 1, \dots, M$}
\end{align}
As it can be observed in figure \eqref{fig:finitedifferencesschemes:explicit_stencil}, the first and second order central finite difference approximations at node $(x_i, t_{n+1})$ require to compute the difference at the nodes $(x_{i-1}, t_{n+1})$ and $(x_{i+1}, t_{n+1})$. Hence, we can only approximate the spatial partial derivative at the internal region of the grid $\mathcal{G}$ given by the nodes $(x_i, t_n)$ for $i=1,\dots,M$. Also note, that the central finite difference has second order convergence in space. In other words, as we decrease $\Delta{x}$ by one decimal place, the approximation error will decrease by two decimal places.

Analogously, the backward difference approximation at $t_{n+1}$ for $v(x, t)$ and the optimal exercise price $\bar{S}(t)$ is given by
\begin{align}
  \label{eq:finitedifferencesschemes:explicit:temporal_backward_finite_difference}
  \dfrac{v^{n+1}_{i} - v^{n}_{i}}{\Delta{t}} &= \dfrac{\partial{v}}{\partial{t}}+ O(\Delta{t}) \qquad & \text{for $n = N,\dots,0$ } \\
  \label{eq:finitedifferencesschemes:explicit:front_temporal_backward_finite_difference}
  \dfrac{\bar{S}^{n+1}-\bar{S}^{n}}{\Delta t} &= \bar{S}'(t) + O(\Delta{t}) \qquad & \text{for $n = N,\dots,0$ }
\end{align}
Contrary to the central finite difference, the backward finite difference approximations have first order convergence in time. While it would be desirable to have second order convergence for the temporal partial derivative approximation, it is not possible use central finite difference because we would be required to have two boundary conditions in the time axis. By combining the finite difference approximations \eqref{eq:finitedifferencesschemes:explicit:spatial_first_order_central_finite_difference}, \eqref{eq:finitedifferencesschemes:explicit:spatial_second_order_central_finite_difference}, \eqref{eq:finitedifferencesschemes:explicit:temporal_backward_finite_difference}, and \eqref{eq:finitedifferencesschemes:explicit:temporal_backward_finite_difference},the approximation of the PDE in \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde} is given by 
\begin{equation*}
  \begin{split}
    \dfrac{v^{n+1}_{i} - v^{n}_{i}}{\Delta{t}} & + \dfrac{1}{2}\sigma^2 x_i^2 \dfrac{v^{n+1}_{i-1} - 2v^{n+1}_{i} + v^{n+1}_{i+1}}{(\Delta{x})^2} \\ 
     & + x_i\bigg( (r-\delta) - \dfrac{1}{\bar{S}^{n+1}}\dfrac{\bar{S}^{n+1} - \bar{S}^{n}}{\Delta{t}} \bigg)\dfrac{v^{n+1}_{i+1} - v^{n+1}_{i-1}}{2\Delta{x}} - rv^{n+1}_{i} = 0
  \end{split}
\end{equation*}
for $i = 1, \dots, M$ and $n = N, \dots, 0$. To simplify the expression above, we introduce the terms 
\begin{align*}
  \lambda &:= \dfrac{\Delta{t}}{(\Delta{x})^2} \\
  A_i &:= \dfrac{\lambda}{2}\sigma^2x^{2}_i - \dfrac{\lambda}{2}\bigg((r-\delta) - \dfrac{1}{\Delta{t}}\bigg)x_i\Delta{x} & \text{for $i = 1, \dots, M$} \\ 
  B_i &:= 1 - \lambda\sigma^2x_i^2 - r\Delta{t} & \text{for $i = 1, \dots, M$} \\
  C_i &:= \dfrac{\lambda}{2}\sigma^2x^{2}_i + \dfrac{\lambda}{2}\bigg((r-\delta) - \dfrac{1}{\Delta{t}}\bigg)x_i\Delta{x} &  \text{for $i = 1, \dots, M$} \\
  D^{n+1}_{i} &:= \dfrac{x_i}{2\Delta{x}}\dfrac{v^{n+1}_{i+1} - v^{n+1}_{i-1}}{\bar{S}^{n+1}} &  \text{for $i = 1, \dots, M$}
\end{align*}
Then, we rearrange the finite difference approximation of the PDE as 
\begin{equation}
  v^{n}_{i} - D^{n+1}_{i}\bar{S}^n = A_i v^{n+1}_{i-1} + B_{i}v^{n+1}_{i} + C_{i}v^{n+1}_{i+1}
  \label{eq:finitedifferencesschemes:explicit:pde_simplified}
\end{equation}
for $i = 1, \dots, M$ and $t = N, \dots, 0$. Moreover, the PDE problem in \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde} have well-defined spatial boundary conditions. For call options, the boundary conditions are located at $x=0$ and $x=1$. Similarly, for put options, the boundary conditions are located at $x=1$ and at a sufficient large $x$. However, since the $\mathcal{G}$ is defined in terms of $x_\text{min}$ and $x_\text{max}$, regardless of the option type, the boundary conditions will be always at $x_0$ and $x_{M+1}$.
\begin{subequations}
  \label{eq:finitedifferencesschemes:explicit:boundary_conditions}
  \begin{align}
    \text{\textbf{Call:}} \qquad & v^{n}_{0} = 0, \qquad v^{n}_{M+1} = \bar{S}^{n} - K\\
    \text{\textbf{Put:}} \qquad & v^{n}_{0} = K - \bar{S}^{n}, \qquad v^{n}_{M+1} = 0
  \end{align}
\end{subequations}
Likewise, the terminal conditions are located at $t_{N+1}$ $i=0,\dots,M+1$
\begin{subequations}
  \label{eq:finitedifferencesschemes:explicit:terminal_conditions}
  \begin{equation}
    v^{N+1}_{i} = 0, \qquad \bar{S}^{N+1} = K
  \end{equation}
\end{subequations}
Moreover, for the problem \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde}, we have contact point condition \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_optimal_price_contact_point_condition}. The contact point condition gives the slope at $x=1$. When the option is a call option, $x=1$ correspond to $x_{M+1}$ in the grid $\mathcal{G}$. Reciprocally, for a put option, $x=1$ correspond to $x_0$. Therefore, by using backward difference at $x_{M+1}$ and forward difference at $x_0$, the contact point approximation for call and put options, respectively.
\begin{align*}
  \text{\textbf{Call:}} \qquad & \dfrac{v^{n}_{M+1} - v^{n}_{M}}{\Delta{x}} = \dfrac{\partial{v}}{\partial{x}}(1, t) + O(\Delta{x}) \\
  \text{\textbf{Put:}} \qquad & \dfrac{v^{n}_{1} - v^{n}_{0}}{\Delta{x}} = \dfrac{\partial{v}}{\partial{x}}(1, t)+ O(\Delta{x}) 
\end{align*}
Using the contact point condition, we obtain an explicit expression for $v^{n}_{M}$
\begin{subequations}
  \label{eq:finitedifferencesschemes:explicit:contact_point_approximation_2}
  \begin{align}
    \text{\textbf{Call:}} \qquad& v^{n}_{M} = v^{n}_{M+1} - \Delta{x}\bar{S}^{n} = (1-\Delta{x})\bar{S}^n - K & \qquad \text{for $n = N,\dots,0$ }\\
    \text{\textbf{Put:}} \qquad& v^{n}_{1} = v^{n}_{0} - \Delta{x}\bar{S}^{n} = K - (1+\Delta{x})\bar{S}^n & \qquad \text{for $n = N,\dots,0$ }
  \end{align}    
\end{subequations}
Note that the approximation for $v^{n}_{M}$ has first order convergence in space which could degrade the global convergence of the explicit method to first order in space even if we are using central finite difference to approximate the spatial partial derivatives of $v(x,t)$. Similarly, we can obtain explicit expression for $\bar{S}^{n}$ by computing \eqref{eq:finitedifferencesschemes:explicit:pde_simplified} at $x_M$ and at $x_1$ for call and put options, respectively. Then, rearranging the resulting expression in terms of $\bar{S}^n$ 
\begin{subequations}
  \label{eq:finitedifferencesschemes:explicit:optimal_exercise_price_approximation}
  \begin{align}
    \text{\textbf{Call:}} \qquad& \bar{S}^{n} = \dfrac{K + A_{M}v^{n+1}_{M-1} + B_{M}v^{n+1}_{M} + C_{M}v^{n+1}_{M+1}}{(1-\Delta{x}) - D^{n+1}_{M}} \\
    \text{\textbf{Put:}} \qquad& \bar{S}^{n} = \dfrac{K - (A_{1}v^{n+1}_{0} + B_{1}v^{n+1}_{1} + C_{1}v^{n+1}_{2})}{D^{n+1}_1 + (1+\Delta{x})}
  \end{align}
\end{subequations}
for $n = N,\dots,0$. Thus, combining \eqref{eq:finitedifferencesschemes:explicit:pde_simplified}, \eqref{eq:finitedifferencesschemes:explicit:boundary_conditions}, 
\eqref{eq:finitedifferencesschemes:explicit:terminal_conditions},
\eqref{eq:finitedifferencesschemes:explicit:contact_point_approximation_2}, and \eqref{eq:finitedifferencesschemes:explicit:optimal_exercise_price_approximation}, the explicit scheme of PDE problem \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde} is given by
\begin{subequations}
  \label{eq:finitedifferencesschemes:explicit:nielsen_system_of_equation}
  \begin{align}
    \text{\textbf{Call:}} \quad& \begin{cases}
      v^{n}_{i} - D^{n+1}_{i}\bar{S}^n = A_i v^{n+1}_{i-1} + B_{i}v^{n+1}_{i} + C_{i}v^{n+1}_{i+1} & \text{for $i = 1, \dots, M-1$ and $n = N,\dots, 0$}\\
      v^{N+1}_i = 0 & \text{for $i = 0, \dots, M+1$}  \\
      \bar{S}^{N+1} = K \\
      v^{n}_0 = 0 & \text{for $n = N, \dots, 0$} \\ 
      v^{n}_{M} = (1-\Delta{x})\bar{S}^n - K & \text{for $n = N, \dots, 0$} \\
      v^{n}_{M+1} = \bar{S}^n - K  & \text{for $n = N, \dots, 0$}
    \end{cases}\\
    \text{\textbf{Put:}} \quad&  \begin{cases}
      v^{n}_{i} - D^{n+1}_{i}\bar{S}^n = A_i v^{n+1}_{i-1} + B_{i}v^{n+1}_{i} + C_{i}v^{n+1}_{i+1} & \text{for $i = 2, \dots, M$ and $n = N,\dots,0$} \\
      v^{N+1}_i = 0 & \text{for $i = 0, \dots, M+1$} \\ 
      \bar{S}^{N+1} = K \\
      v^{n}_{0} = K - \bar{S}^{n} & \text{for $n = N, \dots, 0$} \\
      v^{n}_{1} =  K - (1+\Delta{x})\bar{S}^{n}  & \text{for $n = N, \dots, 0$} \\
      v^{n}_{M} = 0 & \text{for $n = N, \dots 0$}
    \end{cases}
  \end{align}
\end{subequations}
Finally, we formulate an algorithm for solving the system \eqref{eq:finitedifferencesschemes:explicit:nielsen_system_of_equation}
\begin{algorithm}[H]
  \caption{Explicit method for call options} \label{alg:finitedifferencesschemes:explicit:call_explicit_method_algorithm}
  \begin{algorithmic}
  \Ensure $\lambda \le 0.5$
  
  \For{$i = 0,\dots,M+1$} 
    \State $v^{N+1}_i = 0 $
  \EndFor
  
  \State $\bar{S}^{N+1} = K$

  \For{$i = 1,\dots,M$} 
    \State $A_i = \dfrac{\lambda}{2}\sigma^2x^{2}_i - \dfrac{\lambda}{2}\bigg((r-\delta) - \dfrac{1}{\Delta{t}}\bigg)x_i\Delta{x}$
    \State $B_i = 1 - \lambda\sigma^2x_i^2 - r\Delta{t} $
    \State $C_i = \dfrac{\lambda}{2}\sigma^2x^{2}_i + \dfrac{\lambda}{2}\bigg((r-\delta) - \dfrac{1}{\Delta{t}}\bigg)x_i\Delta{x} $
  \EndFor
  
  \For{$n = N, \dots, 0$}
    \For{$i = 1, \dots, M$}
      \State $D^{n+1}_i = \dfrac{x_i}{2\Delta{x}}\dfrac{v^{n+1}_{i+1} - v^{n+1}_{i-1}}{\bar{S}^{n+1}}$
    \EndFor
    \State $\bar{S}^n = \dfrac{K + A_{M}v^{n+1}_{M-1} + B_{M}v^{n+1}_{M} + C_{M}v^{n+1}_{M+1}}{(1-\Delta{x}) - D^{n+1}_{M}}$
    \State $v^{n}_{0} = 0$
    \State $v^{n}_{M} = (1-\Delta{x})\bar{S}^{n} - K$
    \State $v^{n}_{M+1} = \bar{S}^{n} - K$
    \For{$i = 1, \dots, M-1$}
      \State $v^{n}_{i} = A_i v^{n+1}_{i-1} + B_{i}v^{n+1}_{i} + C_{i}v^{n+1}_{i+1} + D^{n+1}_{i}\bar{S}^n$
    \EndFor
  \EndFor
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
  \caption{Explicit method for put options}\label{alg:finitedifferencesschemes:explicit:put_explicit_method_algorithm}
  \begin{algorithmic}
  \For{$i = 0,\dots,M+1$} 
    \State $v^{N+1}_i = 0 $
  \EndFor
  \State $\bar{S}^{N+1} = K$
  \For{$i = 1,\dots,M$} 
    \State $A_i = \dfrac{\lambda}{2}\sigma^2x^{2}_i - \dfrac{\lambda}{2}\bigg((r-\delta) - \dfrac{1}{\Delta{t}}\bigg)x_i\Delta{x}$
    \State $B_i = 1 - \lambda\sigma^2x_i^2 - r\Delta{t} $
    \State $C_i = \dfrac{\lambda}{2}\sigma^2x^{2}_i + \dfrac{\lambda}{2}\bigg((r-\delta) - \dfrac{1}{\Delta{t}}\bigg)x_i\Delta{x} $
  \EndFor
  \For{$n = N, \dots, 0$}
    \For{$i = 1, \dots, M$}
      \State $D^{n+1}_i = \dfrac{x_i}{2\Delta{x}}\dfrac{v^{n+1}_{i+1} - v^{n+1}_{i-1}}{\bar{S}^{n+1}}$
    \EndFor
    \State $\bar{S}^n = \dfrac{K - (A_{1}v^{n+1}_{0} + B_{1}v^{n+1}_{1} + C_{1}v^{n+1}_{2})}{D^{n+1}_{1} + (1+\Delta{x})}$
    \State $v^{n}_{0} = K - \bar{S}^{n}$
    \State $v^{n}_{1} = K - (1+\Delta{x})\bar{S}^n$
    \State $v^{n}_{M+1} = 0$
    \For{$i = 2, \dots, M$}
      \State $v^{n}_{i} = A_i v^{n+1}_{i-1} + B_{i}v^{n+1}_{i} + C_{i}v^{n+1}_{i+1} + D^{n+1}_{i}\bar{S}^n$
    \EndFor
  \EndFor
\end{algorithmic}
\end{algorithm}
\newpage
\subsection{Implicit scheme}
Analogously to the previous section, implicit methods approximate the temporal partial derivative using backward difference and the spatial partial derivative using a central difference at time $t_n$ and position $x_i$. Since the PDE in \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde} is written backward in time, we use a forward difference instead.
\begin{figure}[H]
  \centering
  \includegraphics[scale=.8]{chapters/chapter3/ImplicitStencil.pdf}
  \caption{Stencil diagram of the implicit scheme.}
  \label{fig:finitedifferencesschemes:implicit_stencil}
\end{figure}
Therefore, the central difference for the first and second order spatial partial derivative at time $t_n$ is 
\begin{align}
  \label{eq:finitedifferencesschemes:implicit:spatial_first_order_central_finite_difference}
  \dfrac{v^{n}_{i+1} - v^{n}_{i-1}}{2 \Delta{x}} =& \dfrac{\partial{v}}{\partial{x}}+ O(\Delta{x}^2) \\
  \label{eq:finitedifferencesschemes:implicit:spatial_second_order_central_finite_difference}
  \dfrac{v^{n}_{i+1} - 2v^{n}_{i} + v^{n}_{i-1}}{\Delta{x}^2} =& \dfrac{\partial^2{v}}{\partial{x^2}}+ O(\Delta{x}^2)
\end{align}
for $i = 1, \dots, M$. Likewise, the forward difference of $v(x, t)$ and $\bar{S}(t)$ at position $x_i$ is  
\begin{align}
  \label{eq:finitedifferencesschemes:implicit:temporal_backward_finite_difference}
  \dfrac{v^{n+1}_{i} - v^{n}_{i}}{\Delta{t}} &= \dfrac{\partial{v}}{\partial{t}}+ O(\Delta{t}) \\
  \label{eq:finitedifferencesschemes:implicit:front_temporal_backward_finite_difference}
  \dfrac{\bar{S}^{n+1}-\bar{S}^{n}}{\Delta t} &= \bar{S}'(t) + O(\Delta{t}) \qquad & \text{ }
\end{align}
for $n = N,\dots,0$. Hence, combining \eqref{eq:finitedifferencesschemes:implicit:spatial_first_order_central_finite_difference}, \eqref{eq:finitedifferencesschemes:implicit:spatial_second_order_central_finite_difference}, \eqref{eq:finitedifferencesschemes:implicit:temporal_backward_finite_difference} and \eqref{eq:finitedifferencesschemes:implicit:front_temporal_backward_finite_difference},we obtain the implicit approximation of the PDE \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde} as
\begin{equation*}
  \begin{split}
    \dfrac{v^{n+1}_{i} - v^{n}_{i}}{\Delta{t}} & + \dfrac{1}{2}\sigma^2 x_i^2 \dfrac{v^{n}_{i-1} - 2v^{n}_{i} + v^{n}_{i+1}}{(\Delta{x})^2} \\ 
     & + x_i\bigg( (r-\delta) - \dfrac{1}{\bar{S}^{n}}\dfrac{\bar{S}^{n+1} - \bar{S}^{n}}{\Delta{t}} \bigg)\dfrac{v^{n}_{i+1} - v^{n}_{i-1}}{2\Delta{x}} - rv^{n}_{i} = 0
  \end{split}
\end{equation*}
for $i=1,\dots,M$ and $n=N,\dots,0$. Similar to the explicit method, the approximation error is second order in space and first order in time. Again, to make the implicit  approximation more manageable, we introduce the following terms  
\begin{align}
  \alpha^{n}_{i} &:= -\dfrac{\lambda}{2}\sigma^2x^{2}_{i} + \dfrac{\lambda\Delta{x}}{2}x_{i}\bigg(r-\delta+\dfrac{\bar{S}^{n+1}-\bar{S}^n}{\Delta{t}\bar{S}^{n}}\bigg) \\
  \beta^{n}_{i} &:= 1 + \lambda\sigma^2x^{2}_{i} + r\Delta{t} \\
  \gamma^{n}_{i} &:= -\dfrac{\lambda}{2}\sigma^2x^{2}_{i} + \dfrac{\lambda\Delta{x}}{2}x_{i}\bigg(r-\delta+\dfrac{\bar{S}^{n+1}-\bar{S}^n}{\Delta{t}\bar{S}^{n}}\bigg)
\end{align}
and rearrange the PDE as
\begin{equation}
  \label{eq:finitedifferencesschemes:implicit:implicit_scheme_simplified}
  \alpha^{n}_{i}v^{n}_{i-1} + \beta^{n}_{i}v^{n}_{i} + \gamma^{n}_{i}v^{n}_{i+1} = v^{n+1}_{i}
\end{equation}
The boundary and terminal conditions are given by \eqref{eq:finitedifferencesschemes:explicit:boundary_conditions} and \eqref{eq:finitedifferencesschemes:explicit:terminal_conditions}. Likewise, the approximation of $v^{n}_{M}$ or $v^{n}_{1}$ for put and call, respectively, is given by \eqref{eq:finitedifferencesschemes:explicit:contact_point_approximation_2}. Similar to the explicit method, the approximation $v^{n}_{M}$ and $v^{n}_{0}$ given by the contact point condition is first order in space. Hence, the global approximation error of implicit scheme might be degraded to first order in space. Contrary to the explicit method, there is not an explicit expression for $\bar{S^n}$. Now, we formulate the system of equations of the problem \eqref{eq:blackscholes:frontfixingmethod:inversetransform:american_options_bs_pde}
using \eqref{eq:finitedifferencesschemes:explicit:boundary_conditions}, \eqref{eq:finitedifferencesschemes:explicit:terminal_conditions}, \eqref{eq:finitedifferencesschemes:explicit:contact_point_approximation_2} and \eqref{eq:finitedifferencesschemes:implicit:implicit_scheme_simplified}
\begin{subequations}
  \label{eq:finitedifferencesschemes:implicit:nielsen_system_of_equation}
  \begin{align}
    \text{\textbf{Call:}} \quad& \begin{cases}
      \alpha^{n}_{i}v^{n}_{i-1} + \beta^{n}_{i}v^{n}_{i} + \gamma^{n}_{i}v^{n}_{i+1} = v^{n+1}_{i} & \text{for $i = 1, \dots, M-1$ and $n = N,\dots,0$} \\
      v^{N+1}_i = 0 & \text{for $i = 0, \dots, M+1$}\\
      \bar{S}^{N+1} = K \\
      v^{n}_0 = 0 & \text{for $n = N, \dots 0$}\\
      v^{n}_{M} = (1-\Delta{x})\bar{S}^n - K & \text{for $n = N, \dots 0$}\\
      v^{n}_{M+1} = \bar{S}^n - K  & \text{for $n = N, \dots 0$}
    \end{cases}\\
    \text{\textbf{Put:}} \quad& \begin{cases}
      \alpha^{n}_{i}v^{n}_{i-1} + \beta^{n}_{i}v^{n}_{i} + \gamma^{n}_{i}v^{n}_{i+1} = v^{n+1}_{i} & \text{for $i = 2, \dots, M$ and $n = N,\dots,0$} \\
      v^{N+1}_i = 0 & \text{for $i = 0, \dots, M+1$} \\
      \bar{S}^{N+1} = K \\
      v^{n}_{0} = K - \bar{S}^{n} & \text{for $n = N, \dots 0$}\\
      v^{n}_{1} =  K - (1+\Delta{x})\bar{S}^{n} & \text{for $n = N, \dots 0$}\\
      v^{n}_{M} = 0 & \text{for $n = N, \dots 0$}
    \end{cases}
  \end{align}
\end{subequations}
Since there is not an explicit formula for $v^{n}_{i}$ and $\bar{S}^n$, we will 
have to solve a non-linear system of equation. Let's define the vector $\mathbf{v}^n \in \mathbb{R}^{M-1}$ 
\begin{subequations}
  \begin{align}
    \text{\textbf{Call:}} \qquad \mathbf{v}^{n} :=& \begin{bmatrix}
      v^{n}_{1}, & v^{n}_{2}, & \cdots, & v^{n}_{M-1}
    \end{bmatrix}^{\text{T}}\\
    \text{\textbf{Put:}} \qquad \mathbf{v}^{n} :=& \begin{bmatrix}
      v^{n}_{2}, & v^{n}_{3}, & \cdots, & v^{n}_{M}
    \end{bmatrix}^{\text{T}}
  \end{align}    
\end{subequations}
the matrix $\Lambda^{n} \in \mathbb{R}^{M-1,M-2}$ 
\begin{subequations}
  \begin{align}
    \text{\textbf{Call:}} \qquad \Lambda^{n} =& \begin{bmatrix}
      \beta^{n}_{1} & \gamma^{n}_1 \\
      \alpha^{n}_{2} & \beta^{n}_{2} & \gamma^{n}_{2} \\
      & \ddots & \ddots & \ddots  \\
      & & \ddots & \ddots & \ddots  \\
      & & & \alpha^{n}_{M-2} & \beta^{n}_{M-2} & \gamma^{n}_{M-2} \\
      & & & & \alpha^{n}_{M-1} & \beta^{n}_{M-1} \\
      & & & & & \alpha^{n}_{M} \\
    \end{bmatrix}\\
    \text{\textbf{Put:}} \qquad  \Lambda^{n} :=& \begin{bmatrix}
      \gamma^{n}_1 \\
      \beta^{n}_2 & \gamma^{n}_2 \\
      \alpha^{n}_3 & \beta^{n}_3 & \gamma^{n}_3 \\
      & \ddots & \ddots & \ddots \\
      & & \ddots & \ddots & \ddots \\
      & & & \alpha^{n}_{M-1} & \beta^{n}_{M-1} & \gamma^{n}_{M-1} \\
      & & & & \alpha^{n}_{M} & \beta^{n}_{M} \\
    \end{bmatrix}
  \end{align}
\end{subequations}
and the vector $\mathbf{f}^{n} \in \mathbb{R}^{M-1}$
\begin{subequations}
  \begin{align}
    \text{\textbf{Call:}} \qquad \mathbf{f}^n :=& \begin{bmatrix}
      v^{n+1}_{1} \\
      \vdots \\
      v^{n+1}_{M-1} - \gamma^{n}_{M-1}[(1-\Delta{x})\bar{S}^{n} - K] \\
      v^{n+1}_{M} - \gamma^{n}_{M}(\bar{S}^n - K) - \beta^{n}_{M}[(1-\Delta{x})\bar{S}^{n} - K]
    \end{bmatrix}\\
    \text{\textbf{Put:}} \qquad \mathbf{f}^n :=& \begin{bmatrix}
      v^{n+1}_{1} - \alpha^{n}_{1}(K - \bar{S}^{n}) - \beta^{n}_{1}[K - (1+\Delta{x})\bar{S}^{n}] \\
      v^{n+1}_{2} - \beta^{n}_2[K - (1+\Delta{x})\bar{S}^{n}] \\
      v^{n+1}_{3} \\
      \vdots \\
      v^{n+1}_{M-1}
    \end{bmatrix}
  \end{align}
\end{subequations}
Thus, the non-linear system of equations that we need to solve is
\begin{equation}
  F(\mathbf{v}^{n}, \bar{S}^{n}) = \Lambda^{n}\mathbf{v}^{n} - \mathbf{f}^n = 0
\end{equation}

By computing the Jacobian of the system, we con solve the non-linear system 
using the newton's method

\begin{equation}
  \mathbf{y}_{k+1} = \mathbf{y}_{k} - J^{-1}(\mathbf{y}_{k})F(\mathbf{y}_{k})
\end{equation}

where $y_k$ is some approximation of the solution
\begin{equation}
  \mathbf{y} = \begin{bmatrix}
    \mathbf{v}^{n} | \bar{S}^{n}
  \end{bmatrix}^{\text{T}}
\end{equation}

\subsection{Numerical results}
Generally, Datasets for American options are hard to get and often require paying substantial amount of money. Therefore, to validate our implementation, we mainly relied on the data available in Company, 
et al. \cite*{company_egorova_jodar_2014}, Nielsen, et al. \cite*{nielsen_2001}, Seydel \cite*{seydel_2009}, and Wilmott, et al. \cite*{wilmott_howison_dewynne_1995}. Moreover, we used the approximations produced by the binomial model introduced by Cox et al. \cite{cox_1979} as benchmark for assessing the consistency of our method. We chose the binomial model because it uses a completely different approach to price options than the one considered in our work, is widely used in the industry, and is simple to implement. First, 
we want to assess the correct functionality of our implementation. With that objective, we define the set of parameters taken from \cite{nielsen_2001}

\begin{equation}
  \label{eq:numericaresults:parameters_set_1}
  K = 1, \quad T = 1, \quad r=0.2, \quad \sigma=0.2, \quad \delta = 0 
\end{equation}

Moreover, Nielsen \cite{nielsen_2001} suggests that the optimal exercise boundary $\bar{S}(t) \approx 0.86$ for parameters \eqref{eq:numericaresults:parameters_set_1}. Then, we validated that the binomial model produces a similar approximation for $\bar{S}(t)$. Finally, we priced a put option using our implementation of the explicit \eqref{eq:finitedifferencesschemes:explicit:nielsen_system_of_equation} and implicit \eqref{eq:finitedifferencesschemes:implicit:nielsen_system_of_equation} method for the Nielsen transformation, and the explicit method for the Company transformation \eqref{alg:appendix:companytransformation:explicits:put_explicit_method_algorithm}. In tables \eqref{tab:rsme_explicit_nielsen_transformation} and \eqref{tab:rsme_explicit_company_transformation}, you can find the RMSE error produced by the explicit method for Nielsen and Company transformation.

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[H]
    \centering
    \begin{tabular}{@{}ccccccc@{}}
    \toprule
    \textbf{Asset price} & \textbf{BOPM} & 0.125    & 0.0625   & 0.03125  & 0.015625 & 0.0078125 \\ \midrule
    0.8                  & 0.200000      & 0.200000 & 0.200000 & 0.200000 & 0.200000 & 0.200000  \\
    1.0                  & 0.048167      & 0.046048 & 0.047748 & 0.048176 & 0.048160 & 0.048155  \\
    1.2                  & 0.008666      & 0.008661 & 0.008638 & 0.008705 & 0.008674 & 0.008662  \\
    1.4                  & 0.001285      & 0.001467 & 0.001369 & 0.001313 & 0.001292 & 0.001286  \\
    1.6                  & 0.000167      & 0.000237 & 0.000196 & 0.000176 & 0.000170 & 0.000168  \\
    1.8                  & 0.000020      & 0.000038 & 0.000027 & 0.000022 & 0.000021 & 0.000020  \\
    2.0                  & 0.000002      & 0.000006 & 0.000004 & 0.000003 & 0.000002 & 0.000002  \\
                         & \textbf{RMSE} & 0.000080 & 0.000016 & 0.000002 & 0.00000  & 0.000000  \\ \bottomrule
    \end{tabular}
    \caption{\label{tab:rsme_explicit_nielsen_transformation}RSME error produced by the explicit scheme for the Nielsen transformation for $\Delta{t}=1/8,1/16,\dots,1/128$ and $\Delta{t}=\Delta{x}^2/2$.}
\end{table}


% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[H]
    \centering
    \begin{tabular}{@{}ccccccc@{}}
    \toprule
    \textbf{Asset price} & \textbf{BOPM} & 0.125    & 0.0625   & 0.03125  & 0.015625 & 0.0078125 \\ \midrule
    0.8                  & 0.200000      & 0.200000 & 0.200000 & 0.200000 & 0.200000 & 0.200000  \\
    1.0                  & 0.048167      & 0.049286 & 0.049274 & 0.048465 & 0.048256 & 0.048174  \\
    1.2                  & 0.008666      & 0.010736 & 0.009108 & 0.008829 & 0.008686 & 0.008667  \\
    1.4                  & 0.001285      & 0.001950 & 0.001501 & 0.001349 & 0.001295 & 0.001287  \\
    1.6                  & 0.000167      & 0.000354 & 0.000224 & 0.000185 & 0.000172 & 0.000168  \\
    1.8                  & 0.000020      & 0.000076 & 0.000035 & 0.000024 & 0.000021 & 0.000020  \\
    2.0                  & 0.000002      & 0.000017 & 0.000006 & 0.000003 & 0.000003 & 0.000002  \\
    & \textbf{RSME} & 0.000092 & 0.000045 & 0.000013 & 0.000003 & 0.00000   \\ \bottomrule
    \end{tabular}
    \caption{\label{tab:rsme_explicit_company_transformation}RSME error produced by the explicit scheme for Company transformation for $\Delta{t}=1/8,1/16,\dots,1/128$ and $\Delta{t}=\Delta{x}^2/2$.}
\end{table}

Moreover, figure \eqref{fig:finitedifferencesschemes:numericaresults:test_case_2_explicit} show the $V(S, 0)$ curve obtained by the Nielsen and Company explicit method. In each plot, we have listed the optimal exercise boundary $\bar{S}(0)$. Also, we have listed the correspondent value curve produced using the binary option pricing model using $2^500$ nodes. As you see, Nielsen and Company approximated optimal exercise boundary within 2 decimal places. 

\begin{figure}[H]
  \centering
  \begin{subfigure}{0.435\textwidth}
    \label{fig:finitedifferencesschemes:numericaresults:test_case_2_bopm}
    \centering
    \includegraphics[width=\textwidth]{chapters/chapter3/TestCase2BOPM.pdf}
    \caption{Binary model of $2^{500}$ nodes.}
  \vspace{0.5cm}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
    \label{fig:finitedifferencesschemes:numericaresults:test_case_2_explicit_nielsen}
    \centering
    \includegraphics[width=\textwidth]{chapters/chapter3/TestCase2NielsenExplicit.pdf}
    \caption{Nielsen transformation with $\Delta{x}=\expnumber{1}{-3}$ and $\Delta{t}=0.5\times\expnumber{1}{-6}$}
  \end{subfigure}
  \begin{subfigure}{0.435\textwidth}
    \label{fig:finitedifferencesschemes:numericaresults:test_case_2_explicit_company}
    \centering
    \includegraphics[width=\textwidth]{chapters/chapter3/TestCase2CompanyExplicit.pdf}
    \caption{Company transformation $\Delta{x}=\expnumber{1}{-3}$ and $\Delta{t}=0.5\times\expnumber{1}{-6}$}
  \end{subfigure}
  \caption{American put option value $V(S, 0)$ curve.}
  \label{fig:finitedifferencesschemes:numericaresults:test_case_2_explicit}
\end{figure}

Additionally, table \eqref{tab:rsme_implicit_nielsen_transformation} present the RSME error produced by the implicit method for the Nielsen transformation and figure \eqref{fig:finitedifferencesschemes:numericaresults:test_case_2_implicit} show the value curve obtained by using the implicit method for the Nielsen approximation.

\begin{figure}[H]
  \centering
  \begin{subfigure}{0.435\textwidth}
    \label{fig:finitedifferencesschemes:numericaresults:test_case_2_implicit_bopm}
    \centering
    \includegraphics[width=\textwidth]{chapters/chapter3/TestCase2BOPM.pdf}
    \caption{Binary model of $2^{500}$ nodes.}
    \vspace{0.5cm}
  \end{subfigure}
  \begin{subfigure}{0.4\textwidth}
    \label{fig:finitedifferencesschemes:numericaresults:test_case_2_implicit_nielsen}
    \centering
    \includegraphics[width=\textwidth]{chapters/chapter3/TestCase2NielsenExplicit.pdf}
    \caption{Implicit method for Nielsen transformation with $\Delta{x}=\Delta{t}=\expnumber{1}{-3}$.}
  \end{subfigure}
  \caption{American put option value $V(S, 0)$ curve.}
  \label{fig:finitedifferencesschemes:numericaresults:test_case_2_implicit}
\end{figure}

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[H]
  \centering
  \begin{tabular}{@{}ccccccc@{}}
  \toprule
  \textbf{Asset price} & \textbf{BOPM}        & 0.125      & 0.0625     & 0.03125    & 0.015625   & 0.0078125  \\ \midrule
  0.8                  & 0.200000             & 0.224810   & 0.227045   & 0.200000   & 0.200000   & 0.200000   \\
  1.0                  & 0.048167             & 0.156141   & 0.159308   & 0.080886   & 0.053942   & 0.048944   \\
  1.2                  & 0.008666             & 0.114815   & 0.117140   & 0.041319   & 0.013783   & 0.009290   \\
  1.4                  & 0.001285             & 0.080638   & 0.081485   & 0.023604   & 0.003694   & 0.001519   \\
  1.6                  & 0.000167             & 0.047914   & 0.048026   & 0.014269   & 0.001085   & 0.000229   \\
  1.8                  & 0.000020             & 0.019130   & 0.020665   & 0.008591   & 0.000353   & 0.000033   \\
  2.0                  & 0.000002             & 0.000022   & 0.003408   & 0.004695   & 0.000125   & 0.000005   \\
                       & \textbf{Asset price} & 0.06812077 & 0.06970396 & 0.02045601 & 0.00307761 & 0.00038755 \\ \bottomrule
  \end{tabular}
  \caption{\label{tab:rsme_implicit_nielsen_transformation}RSME error produced by the implicit scheme for the Nielsen transformation for $\Delta{x}=\Delta{t}=1/8,1/16,\dots,1/128$.}
\end{table}

In the figures  \eqref{fig:finitedifferencesschemes:numericaresults:test_case_2_explicit} and \eqref{fig:finitedifferencesschemes:numericaresults:test_case_2_implicit}, we observe that the approximation follows the geometry of American options. Specifically, within the continuation region $S>\bar{S}(0)$, the value is larger than the payoff function and as S gets larger, the value goes to zero. In addition, the value curve is exactly the payoff. Also notice that the RSME of the implicit method for Nielsen transformation is larger than the explicit method for both Company and Nielsen transformation. The explanation we have for this is that for the implicit method we have to solve a non-linear system of equation. Therefore, the error produced by the implicit version of Nielsen will be affected by the error produced by non-linear solver. 

We realized numerous testings to validate the correct functionality of our implementation. As Merton \cite{merton_1973} showed, pricing American call options without dividends is equivalent to solve the price of European options. Therefore, the most natural test to conduct is to price American call options without dividends ($\delta=0$) using our implementation and compare the results to the one obtain using the Black-Scholes formula for  \cite{merton_1973}. 

For the following experiments, we use the following set of parameters.

Moreover, \eqref{eq:numericaresults:parameters_set_1}, we tested each scheme for the case of put options. For the setup of the experiments, we priced a put option using the binomial model \cite{cox_1979} with parameters \eqref{eq:numericaresults:parameters_set_1}. Then, we proceed to compute the RSME error 

where $V^{\text{BM}}_i$ is the price produced by the binomial model, and $\hat{V}_i$ is the price produced by our numerical method. In Tables \eqref{tab:rsme_explicit_nielsen_transformation} and \eqref{tab:rsme_explicit_company_transformation} contain the results obtained for Nielsen and Company transformation, respectively, for $\Delta{x}=1/8, 1/16,\dots,1/128$ and $\Delta{t}=\Delta{x}^2$

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[H]
    \begin{tabular}{@{}ccccccc@{}}
        \toprule
        \textbf{Asset price} & \textbf{BOPM} & 0.125    & 0.0625   & 0.03125  & 0.015625 & 0.0078125 \\ \midrule
        0.8                  & 0.200000      & 0.200000 & 0.200000 & 0.200000 & 0.200000 & 0.200000  \\
        1.0                  & 0.048155      & 0.046048 & 0.047748 & 0.048176 & 0.048160 & 0.048155  \\
        1.2                  & 0.008662      & 0.008661 & 0.008638 & 0.008705 & 0.008674 & 0.008662  \\
        1.4                  & 0.001286      & 0.001467 & 0.001369 & 0.001313 & 0.001292 & 0.001286  \\
        1.6                  & 0.000168      & 0.000237 & 0.000196 & 0.000176 & 0.000170 & 0.000168  \\
        1.8                  & 0.000020      & 0.000038 & 0.000027 & 0.000022 & 0.000021 & 0.000020  \\
        2.0                  & 0.000002      & 0.000006 & 0.000004 & 0.000003 & 0.000002 & 0.000002  \\
                             & \textbf{RMSE} & 0.000081 & 0.000017 & 0.000002 & 0.000000 & 0.000000  \\ \bottomrule
    \end{tabular}
\end{table}

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[H]
    \begin{tabular}{@{}ccccccc@{}}
        \toprule
        \textbf{Asset price} & \textbf{BOPM} & 0.125    & 0.0625   & 0.03125  & 0.015625 & 0.0078125 \\ \midrule
        0.8                  & 0.200000      & 0.224810 & 0.227045 & 0.200000 & 0.200000 & 0.200000  \\
        1.0                  & 0.048180      & 0.156141 & 0.159308 & 0.080886 & 0.053942 & 0.048944  \\
        1.2                  & 0.008661      & 0.114815 & 0.117140 & 0.041319 & 0.013783 & 0.009290  \\
        1.4                  & 0.001283      & 0.080638 & 0.081485 & 0.023604 & 0.003694 & 0.001519  \\
        1.6                  & 0.000167      & 0.047914 & 0.048026 & 0.014269 & 0.001085 & 0.000229  \\
        1.8                  & 0.000020      & 0.019130 & 0.020665 & 0.008591 & 0.000353 & 0.000033  \\
        2.0                  & 0.000002      & 0.000022 & 0.003408 & 0.004695 & 0.000125 & 0.000005  \\
                             & \textbf{RMSE} & 0.068119 & 0.069703 & 0.020455 & 0.003076 & 0.000385  \\ \bottomrule
    \end{tabular}
\end{table}

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[H]
    \begin{tabular}{@{}ccccccc@{}}
        \toprule
        \textbf{Asset price} & \textbf{BOPM} & 0.125    & 0.0625   & 0.03125  & 0.015625 & 0.0078125 \\ \midrule
        0.8                  & 0.200000      & 0.200000 & 0.200000 & 0.200000 & 0.200000 & 0.200000  \\
        1.0                  & 0.048180      & 0.054188 & 0.053469 & 0.052440 & 0.052340 & 0.052259  \\
        1.2                  & 0.008661      & 0.012658 & 0.010936 & 0.010331 & 0.010294 & 0.010271  \\
        1.4                  & 0.001283      & 0.002423 & 0.001855 & 0.001694 & 0.001650 & 0.001640  \\
        1.6                  & 0.000167      & 0.000462 & 0.000292 & 0.000250 & 0.000234 & 0.000229  \\
        1.8                  & 0.000020      & 0.000107 & 0.000048 & 0.000034 & 0.000030 & 0.000029  \\
        2.0                  & 0.000002      & 0.000028 & 0.000009 & 0.000005 & 0.000004 & 0.000004  \\
                             & \textbf{RMSE} & 0.002763 & 0.002187 & 0.001737 & 0.001695 & 0.001663  \\ \bottomrule
    \end{tabular}
\end{table}

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[H]
    \begin{tabular}{@{}lllllll@{}}
        \toprule
        \textbf{Asset Price} & \textbf{BOPM} & 0.125    & 0.0625   & 0.03125  & 0.015625 & 0.0078125 \\ \midrule
        0.8                  & 0.170000      & 0.170000 & 0.170000 & 0.170000 & 0.170000 & 0.170000  \\
        1.0                  & 0.037785      & 0.038365 & 0.038260 & 0.037619 & 0.037754 & 0.037773  \\
        1.2                  & 0.006576      & 0.007278 & 0.006645 & 0.006602 & 0.006573 & 0.006573  \\
        1.4                  & 0.000953      & 0.001132 & 0.001013 & 0.000969 & 0.000953 & 0.000952  \\
        1.6                  & 0.000122      & 0.000185 & 0.000142 & 0.000128 & 0.000124 & 0.000123  \\
        1.8                  & 0.000015      & 0.000038 & 0.000021 & 0.000016 & 0.000015 & 0.000015  \\
        2.0                  & 0.000002      & 0.000008 & 0.000003 & 0.000002 & 0.000002 & 0.000002  \\
                             & \textbf{RMSE} & 0.000035 & 0.000018 & 0.000006 & 0.000001 & 0.000000  \\ \bottomrule
    \end{tabular}
\end{table}